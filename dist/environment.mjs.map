{"version":3,"file":"environment.mjs","sources":["../lib/environment.js"],"sourcesContent":["ï»¿//@ts-check\n\nexport const environment = (globalThis => {\n\tconst environment = {};\n\n\t/** @type {Set<string>} */\n\tconst warnings = new Set();\n\n\t/** @type {Globals} */\n\t//@ts-ignore\n\tenvironment.globalThis = globalThis;\n\n\tconst warning = message => {\n\t\twarnings.add(message);\n\t};\n\n\tif (environment.globalThis || warning('No valid globalThis object in scope')) {\n\t\tconst {globalThis, warnings} = environment;\n\n\t\tconst globalProperties = ['global', 'window', 'self'];\n\n\t\tfor (const globalProperty of globalProperties)\n\t\t\tglobalProperty in globalThis &&\n\t\t\t\tglobalThis[globalProperty] != null &&\n\t\t\t\ttypeof globalThis[globalProperty] === 'object' &&\n\t\t\t\t(globalThis[globalProperty] === globalThis[globalProperty][globalProperty]\n\t\t\t\t\t? (environment[globalProperty] = globalThis[globalProperty])\n\t\t\t\t\t: warning(`An invalid ${globalProperty} was found in scope`));\n\n\t\tif (\n\t\t\tglobalProperties.findIndex(property => property in environment) > -1 ||\n\t\t\twarning(`No valid ${globalProperties.join(', ')} object(s) in scope`)\n\t\t) {\n\t\t\tconst {global, window, self, process} = environment.globalThis;\n\n\t\t\tif (environment.global !== undefined) {\n\t\t\t\t/** @type {Environment['global']} */\n\t\t\t\tenvironment.global = global;\n\n\t\t\t\tprocess == null ||\n\t\t\t\t\ttypeof process.pid !== 'number' ||\n\t\t\t\t\t/** @type {Environment['process']} */\n\t\t\t\t\t(environment.process = process);\n\t\t\t}\n\t\t\tif (environment.self !== undefined) {\n\t\t\t\t/** @type {Environment['self']} */\n\t\t\t\tenvironment.self = self;\n\n\t\t\t\tif (environment.window !== undefined) {\n\t\t\t\t\t/** @type {Environment['window']} */\n\t\t\t\t\tenvironment.window = window;\n\t\t\t\t\tconst {document} = window;\n\t\t\t\t\tdocument != null && document.defaultView === window && (environment.document = document);\n\t\t\t\t} else if (\n\t\t\t\t\ttypeof self.ServiceWorkerGlobalScope === 'function' &&\n\t\t\t\t\tself instanceof self.ServiceWorkerGlobalScope\n\t\t\t\t) {\n\t\t\t\t\t/** @type {Environment['serviceWorker']} */\n\t\t\t\t\t//@ts-ignore\n\t\t\t\t\tenvironment.serviceWorker = self;\n\t\t\t\t} else if (\n\t\t\t\t\ttypeof self.DedicatedWorkerGlobalScope === 'function' &&\n\t\t\t\t\tself instanceof self.DedicatedWorkerGlobalScope\n\t\t\t\t) {\n\t\t\t\t\t/** @type {Environment['worker']} */\n\t\t\t\t\t//@ts-ignore\n\t\t\t\t\tenvironment.worker = self;\n\t\t\t\t}\n\t\t\t}\n\t\t\tenvironment.global !== undefined && (environment.global = global);\n\t\t}\n\t}\n\n\t// warning('Not a warning');\n\n\twarnings.size && console.warn(['Runtime Warnings:', ...warnings].join('\\n\\t'));\n\n\t/** @type {typeof environment & Environment} */\n\treturn environment;\n})(typeof globalThis === 'object' && globalThis !== null && globalThis === globalThis.globalThis && globalThis);\n\n/** @typedef {import('./types').environment.Environment} Environment */\n/** @typedef {import('./types').environment.Globals} Globals */\n"],"names":[],"mappings":"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"}