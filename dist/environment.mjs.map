{"version":3,"file":"environment.mjs","sources":["../lib/environment.js"],"sourcesContent":["ï»¿//@ts-check\n\nexport const environment = (globalThis => {\n\tconst environment = {};\n\n\t/** @type {Set<string>} */\n\tconst warnings = new Set();\n\n\t/** @type {Globals} */\n\t//@ts-ignore\n\tenvironment.globalThis = globalThis;\n\n\tconst warning = message => {\n\t\twarnings.add(message);\n\t};\n\n\tif (environment.globalThis || warning('No valid globalThis object in scope')) {\n\t\tconst {globalThis, warnings} = environment;\n\n\t\tconst globalProperties = ['global', 'window', 'self'];\n\n\t\tfor (const globalProperty of globalProperties)\n\t\t\tglobalProperty in globalThis &&\n\t\t\t\tglobalThis[globalProperty] != null &&\n\t\t\t\ttypeof globalThis[globalProperty] === 'object' &&\n\t\t\t\t(globalThis[globalProperty] === globalThis[globalProperty][globalProperty]\n\t\t\t\t\t? (environment[globalProperty] = globalThis[globalProperty])\n\t\t\t\t\t: warning(`An invalid ${globalProperty} was found in scope`));\n\n\t\tif (\n\t\t\tglobalProperties.findIndex(property => property in environment) > -1 ||\n\t\t\twarning(`No valid ${globalProperties.join(', ')} object(s) in scope`)\n\t\t) {\n\t\t\tconst {global, window, self, process} = environment.globalThis;\n\n\t\t\tif (environment.global !== undefined) {\n\t\t\t\t/** @type {Environment['global']} */\n\t\t\t\tenvironment.global = global;\n\n\t\t\t\tprocess == null ||\n\t\t\t\t\ttypeof process.pid !== 'number' ||\n\t\t\t\t\t/** @type {Environment['process']} */\n\t\t\t\t\t(environment.process = process);\n\t\t\t}\n\t\t\tif (environment.self !== undefined) {\n\t\t\t\t/** @type {Environment['self']} */\n\t\t\t\tenvironment.self = self;\n\n\t\t\t\tif (environment.window !== undefined) {\n\t\t\t\t\t/** @type {Environment['window']} */\n\t\t\t\t\tenvironment.window = window;\n\t\t\t\t\tconst {document} = window;\n\t\t\t\t\tdocument != null && document.defaultView === window && (environment.document = document);\n\t\t\t\t} else if (\n\t\t\t\t\ttypeof self.ServiceWorkerGlobalScope === 'function' &&\n\t\t\t\t\tself instanceof self.ServiceWorkerGlobalScope\n\t\t\t\t) {\n\t\t\t\t\t/** @type {Environment['serviceWorker']} */\n\t\t\t\t\t//@ts-ignore\n\t\t\t\t\tenvironment.serviceWorker = self;\n\t\t\t\t} else if (\n\t\t\t\t\ttypeof self.DedicatedWorkerGlobalScope === 'function' &&\n\t\t\t\t\tself instanceof self.DedicatedWorkerGlobalScope\n\t\t\t\t) {\n\t\t\t\t\t/** @type {Environment['worker']} */\n\t\t\t\t\t//@ts-ignore\n\t\t\t\t\tenvironment.worker = self;\n\t\t\t\t}\n\t\t\t}\n\t\t\tenvironment.global !== undefined && (environment.global = global);\n\t\t}\n\t}\n\n\t// warning('Not a warning');\n\n\twarnings.size && console.warn(['Runtime Warnings:', ...warnings].join('\\n\\t'));\n\n\t/** @type {typeof environment & Environment} */\n\treturn environment;\n})(typeof globalThis === 'object' && globalThis !== null && globalThis === globalThis.globalThis && globalThis);\n\n/** @typedef {import('./types').environment.Environment} Environment */\n/** @typedef {import('./types').environment.Globals} Globals */\n"],"names":[],"mappings":"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"}